<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>Enter-회원가입</title>
    <!-- MDB icon -->
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" />
    <!-- Google Fonts Roboto -->
    <link
    rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap"
    />
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="register.css">
    <link rel="stylesheet" href="checkbox.css">
    <style>
      .post-slider .card{
        border-radius: 2rem !important;
        height: 464px;
        margin: 0px 20px;
        background-color: transparent;
        box-shadow: none;
       
        
      }
      .form-control::placeholder{
        color: #bfbfbf!important;
      }
      .slick-slide{
        border-radius: 1rem;
      }
      button{
        background-color: transparent;
        border: none;

      }
      @media(min-width:2000px){.container,.container-lg,.container-md,.container-sm,.container-xl,.container-xxl{max-width:1920px!important}}
     
      .slick-slider, .slick-list, .slick-track{
        height: 564px;
      }
      .card-body{
        width: 450px;
      }
      @media(max-width: 992px){
       
      }
    </style>
    
    <!-- MDB -->
    <link rel="stylesheet" href="../css/mdb.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css"/>
    <script  src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script src="../js/slick.js"></script>
  
    <script>
      $(document).ready(function(){
        $("#footer").load("../footer.html");
      });
      /*$(document).ready(function(){
          //Example - show a div after 75% of the web page is scrolled.
          var webpage = $("body");
          var webpage_height = webpage.height();
          //alert(webpage_height);
          var trigger_height = webpage_height * 0.5;

          if ($(window).scrollTop() > (webpage_height-trigger_height)) {
            alert($(window).scrollTop()+" > "+(webpage_height-trigger_height));
            //$("#divtoshow").show();
          }
      });*/

      $(document).on('ready',function(){
        $('.post-slider').slick({
          infinite: true,
          varialbeWidth: true,
          centerMode: false,
          slidesToShow: 1,
          slidesToScroll: 1,
          lazyLoad: 'ondemand',
          prevArrow: $('#prev'),
          prevArrow2: $('#prev2'),
          nextArrow: $('#next'),
          nextArrow2: $('#next2'),
  
        });
      });
      
    </script>
  </head>
  <body style="height: 100vh;">
    <div id="navbar"></div>
    <div class="container-fluid bg-container body-h" style="margin-top:113px; padding: 0px;">
      <div class="container-fluid bg-ver body-h" style="padding: 0px;">
        <div class="hr-1"></div>
        <div class="hr-2"></div>
        
        <div class="container bg-ver2 d-flex mobile-ver-center body-h" style="">
          <div class="hr-3"></div>
          <div class="hr-4"></div>
          <div class="hr-5"></div>
          <div class="hr-6"></div>
          <div class="container" style="height: 757px;padding: 0px;position: relative;">
            <div class="circle-1"></div>
            <div class="circle-2"></div>
            <div class="container text-white" style="max-width: 1320px!important;">
              <div class="row">
                <div class="col-lg-6 mobile-nopad" style="padding: 16px;">
                   <div class="post-slider">
                     <div class="card" >
                      <div class="card-body">
                        <div class="card-text">
                          <p class="card-title-1">Enjoy<br>Our Services</p>
                          <p class="card-title-2 mt-5" style="margin-bottom: 100px;">
                            로그인을 한 뒤에 사전등록을 할 수 있습니다. 더 다양한 혜택과 이벤트 알림을
                            위해 사전등록을 진행해 보세요!
                          </p>
                          <a class="btn-rounded text-white text-center" style="font-size: 18px; background-color: #bd464b;padding:12px 19px;" href="">About Service</a>
                        </div>
                    </div>
                  </div>
                  <div class="card" >
                    <div class="card-body">
                      <div class="card-text">
                        dsklfjklsdfjklsdjfklsdfjklsdfj
                      </div>
                  </div>
                </div>
                <div class="card">
                  <div class="card-body">
                    <div class="card-text">
                      dsklfjklsdfjklsdjfklsdfjklsdfj
                    </div>
                </div>
              </div>
              <div class="card">
                <div class="card-body">
                  <div class="card-text">
                    dsklfjklsdfjklsdjfklsdfjklsdfj
                  </div>
              </div>
            </div>
                   </div>
                   <div class="d-flex mobile-middle" style="padding: 32px;">
              
                    <button class='slick-prev' style="color: #fff;z-index: 1;" id="prev"><i class='fas fa-arrow-left'></i></button>
                    <span class="mx-2"><span id="currentPg" style="color: #fff;">1</span> / <span id="maxPg">4</span></span>
                    <button class='slick-next' style="color: #fff; z-index: 1;" id="next"><i class='fas fa-arrow-right'></i></button>
                  </div>
              </div>
                <div class="col-lg-6 mobile-nopad  d-flex mobile-middle" style="height: 757px; padding-left: 30px; z-index: 1;">
                  <div class="sign-up text-center mobile-nopad">
                    <div class="sign-up-title">
                      Sign up
                    </div>
                    <input type="email" id="userEmail" class="form-control form-rounded mct-5" placeholder="Your email" style="padding: 10px 20px;">
                    <input type="password" id="password" class="form-control form-rounded mct-2" placeholder="Your Password" style="padding: 10px 20px;" onchange="checkPassword();">
                    <input type="password" id="password2" class="form-control form-rounded mct-2" placeholder="Rewrite Password" style="padding: 10px 20px;" onchange="checkPassword();">
                    <span id = "check" style="font-size: 10pt; color: green;">비밀번호를 확인해 주세요</span>
                    <label class="checkbox-container mx-3 mct-5 text-start">I agree to the Terms of Service.
                      <input type="checkbox" checked="checked">
                      <span class="checkmark"></span>
                    </label>
                    <button type="submit" class="btn-rounded text-white text-center" style="font-size: 18px;width: 100%;background-color: #17375E;padding: 12px;" onclick="signUp();">Send Email</button>
                    <div class="separator mt-3">or</div>
                    <button type="submit" class="btn-rounded text-white text-center mt-3" style="
                    font-size: 18px;width: 100%;background-color: #1da1f2;padding: 12px;" onclick="googleLogin();">Login via Google</button>
                    <button type="submit" class="btn-rounded text-white text-center mct-1" style="
                    font-size: 18px;width: 100%;background-color: #fae100;padding: 12px;">Login via Kakao</button>
                    <div class="d-flex mt-3 justify-content-center" style="font-size: 18px;">
                      <div style="color: #bfbfbf;">Do you have an Account?</div>
                      <a class="ms-2" style="color: #59dbe0;" href="../login/login.html">Sign in</a>
                    </div>
                  </div>
              </div>
              </div>
          </div>
          </div>
        </div>
        
    </div>
    </div>
    
    <footer id="footer"></footer>
  

    <!-- MDB -->
    <script type="text/javascript" src="../js/mdb.min.js"></script>
    
    <!-- Custom scripts -->
    <script type="text/javascript">
    $(document).ready(function(){
      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      var firebaseConfig = {
        apiKey: "AIzaSyA0E-3mY4_qBgV7RfxEdzcU4B7xjJ74e-c",
        authDomain: "enter-ef3a8.firebaseapp.com",
        databaseURL: "https://enter-ef3a8-default-rtdb.firebaseio.com",
        projectId: "enter-ef3a8",
        storageBucket: "enter-ef3a8.appspot.com",
        messagingSenderId: "505540008688",
        appId: "1:505540008688:web:d3d89e4a7ac7ba57178035",
        measurementId: "G-88XNV769FN"
      };
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      firebase.analytics();

      firebase.auth().onAuthStateChanged(function(user) {
          if (user) {
            $("#navbar").load('../navbar/afterlogin.html');
            console.log(user)		// 인증 후 어떤 데이터를 받아오는지 확인해보기 위함.
            //window.history.back();
          } else {
            $("#navbar").load('../navbar/beforelogin.html');
            // No user is signed in.
          }
      });
    });
    $(window).load(function(){
      $('#회원가입').addClass('active');
    });
    </script>
    <script type="text/javascript" src="../js/pageSlide.js"></script>
    <script src="register.js"></script>
    
  </body>
  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <!--<script src="/__/firebase/8.6.8/firebase-app.js"></script>

  <script src="/__/firebase/8.6.8/firebase-analytics.js"></script>

  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>

  <script src="/__/firebase/init.js"></script>

  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>

  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-analytics.js"></script>-->

<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.2.2/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/8.2.2/firebase-analytics.js"></script>

<script src="https://www.gstatic.com/firebasejs/8.2.2/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.2.2/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.2.2/firebase-database.js"></script>

<script>
  function checkPassword(){
    var pw1 = document.getElementById('password').value;
    var pw2 = document.getElementById('password2').value;
    if(document.getElementById('password').value.length > 0 && document.getElementById('password').value.length < 6){
      document.getElementById("check").textContent = "비밀번호는 6자 이상으로 설정해주세요"   
      document.getElementById('check').style.color='green';
      pwVerified = false;
    }
    else{  
      if(pw1 == pw2){
        document.getElementById("check").textContent = "비밀번호가 일치합니다"
        document.getElementById('check').style.color='blue';
        pwVerified = true;
      }
      else{
        document.getElementById('check').innerHTML='비밀번호가 일치하지 않습니다'
        document.getElementById('check').style.color='red';
        pwVerified = false;
      }
    }
    return pwVerified;
  }

  function signUp(){
    if(checkPassword()){
      var email = document.getElementById('userEmail').value;
      var password = document.getElementById('password').value;
      if(!email || !password){
        alert("회원가입 정보를 적어주세요");
      }
      else{
        signUpEmail();
      }
    }
  }

  function signUpEmail(){
    var actionCodeSettings = {
      // URL you want to redirect back to. The domain (www.example.com) for this
      // URL must be in the authorized domains list in the Firebase Console.
      url: 'http://localhost:5000/register/email_verify.html',
      // This must be true.
      handleCodeInApp: true
    };

    var email = document.getElementById('userEmail').value;
    var password = document.getElementById('password').value;
    firebase.auth().sendSignInLinkToEmail(email, actionCodeSettings)
    .then(() => {
      // The link was successfully sent. Inform the user.
      // Save the email locally so you don't need to ask the user for it again
      // if they open the link on the same device.
      window.localStorage.setItem('emailForSignIn', email);
      window.localStorage.setItem('setPassword', password);
      alert("이메일 전송 성공");
      // ...
    })
    .catch((error) => {
      var errorCode = error.code;
      var errorMessage = error.message;
      console.log(errorCode);
      alert(errorMessage);
      // ...
    });
  }

  function googleLogin(){
    var user = firebase.auth().currentUser;
    if (user) {
      // User is signed in.
      alert("로그인 완료");
      //console.log(user)		// 인증 후 어떤 데이터를 받아오는지 확인해보기 위함.  
      window.location.href = "register_complete.html";
    } 
    else {
      // No user is signed in.
      var provider = new firebase.auth.GoogleAuthProvider();
      firebase.auth().signInWithRedirect(provider);
    }
  }

  firebase.auth().getRedirectResult()
  .then((result) => {
    if (result.credential) {
      /** @type {firebase.auth.OAuthCredential} */
      var credential = result.credential;
      // This gives you a Google Access Token. You can use it to access the Google API.
      var token = credential.accessToken;
      // ...
    }
    // The signed-in user info.
    var user = result.user;
    var db = firebase.firestore();
    db.collection("user").doc(user.uid).set({
        email: user.email,
        signupMethod: "google",
    })
    .catch(function(error) {
        console.error("Error adding document: ", error);
        alert(error.code+" / "+error.message);
    });
    alert("google 회원가입 완료"+user.email);
  }).catch((error) => {
    // Handle Errors here.
  });
  
</script>
</html>
